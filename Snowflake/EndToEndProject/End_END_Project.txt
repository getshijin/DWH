//create user & create compute wahrehouse

USE ROLE SYSADMIN;

//create DB & schemas
create database if not exists Lending_club;
create or replace schema Lending_club.land;
create or replace schema Lending_club.raw;
create or replace schema Lending_club.clean;
create or replace schema Lending_club.consumption;

show schemas in database Lending_club;

//Create file Format
create or replace file format Lending_club.land.my_csv_format;

GRANT CREATE INTEGRATION ON ACCOUNT TO ROLE SYSADMIN;

//Stprage intergration
CREATE or replace STORAGE INTEGRATION my_s3_integration
  TYPE = EXTERNAL_STAGE
  STORAGE_PROVIDER = S3
  ENABLED = TRUE
  STORAGE_AWS_ROLE_ARN = 'arn:aws:iam::112779684945:role/Snowflake_aws_access'
  STORAGE_ALLOWED_LOCATIONS = ('s3://snowflakes3bucketshijin123/csv/lendingclub/');

//create Stage for accesing the structured or unstructured or semistructured files
create or replace stage Lending_club.land.my_s3_integration
 URL = 's3://snowflakes3bucketshijin123/csv/lendingclub/'
    STORAGE_INTEGRATION = my_s3_integration
    FILE_FORMAT = Lending_club.land.my_csv_format;

//Desc Integration
DESC INTEGRATION my_s3_integration;

//Show stage
list @Lending_club.land.my_s3_integration;






